<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard de Arrecadação - CBMGO</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="dashboard">
      <div class="header">
        <h1>
          Dashboard de Arrecadação - Corpo de Bombeiros Militar do Estado de
          Goiás
        </h1>
        <p>Valores de arrecadação no serviço de vistoria (2022-2024)</p>
      </div>

      <!-- Contêiner das Abas (MODIFICADO) -->
      <div class="tab-container">
        <button
          class="tab-button active"
          onclick="openTab(event, 'visaoGeral')"
        >
          Visão Geral
        </button>
        <button class="tab-button" onclick="openTab(event, 'detalhamentoOBM')">
          Detalhamento OBM
        </button>
        <!-- NOVA ABA -->
        <button class="tab-button" onclick="openTab(event, 'compararOBMs')">
          Comparar OBMs
        </button>
        <button class="tab-button" onclick="openTab(event, 'rankingsAnalises')">
          Rankings e Análises
        </button>
      </div>

      <!-- Conteúdo da Aba Visão Geral (MODIFICADO - Tabela removida) -->
      <div id="visaoGeral" class="tab-content active">
        <!-- Resumo da Arrecadação por Ano -->
        <div class="summary-cards">
          <!-- Cards permanecem aqui -->
          <div class="card">
            <div class="card-title">Arrecadação Total 2022</div>
            <div class="card-value" id="total2022">R$ 51.182.273,35</div>
            <div class="card-subtitle">Base de comparação</div>
          </div>
          <div class="card">
            <div class="card-title">Arrecadação Total 2023</div>
            <div class="card-value" id="total2023">R$ 32.495.850,18</div>
            <div class="card-subtitle growth-negative">
              -36,51% em relação a 2022
            </div>
          </div>
          <div class="card">
            <div class="card-title">Arrecadação Total 2024</div>
            <div class="card-value" id="total2024">R$ 34.252.753,25</div>
            <div class="card-subtitle growth-positive">
              +5,41% em relação a 2023
            </div>
          </div>
        </div>

        <!-- Comparação Entre Anos por Serviço -->
        <div class="section">
          <!-- Gráficos de barras por serviço permanecem aqui -->
          <div class="section-title">Comparação Entre Anos por Serviço</div>
          <div class="chart-row">
            <div class="chart-container">
              <canvas id="projetosYearlyChart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="vistoriasYearlyChart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="credenciamentoYearlyChart"></canvas>
            </div>
          </div>
        </div>

        <!-- Gráficos de Pizza por Serviço -->
        <div class="section">
          <!-- Gráficos de pizza anuais permanecem aqui -->
          <div class="section-title">
            Distribuição da Arrecadação por Tipo de Serviço
          </div>
          <div class="pie-container">
            <div class="pie-chart">
              <canvas id="pieChart2022"></canvas>
            </div>
            <div class="pie-chart">
              <canvas id="pieChart2023"></canvas>
            </div>
            <div class="pie-chart">
              <canvas id="pieChart2024"></canvas>
            </div>
          </div>
        </div>

        <!-- Gráficos de Pizza para Distribuição Goiânia vs Interior por serviço -->
        <div class="section">
          <!-- Gráficos de pizza Gyn/Int permanecem aqui -->
          <div class="section-title">
            Distribuição Goiânia vs Interior por Tipo de Serviço
          </div>
          <div class="pie-container">
            <div class="pie-chart">
              <canvas id="pieChartVistorias"></canvas>
            </div>
            <div class="pie-chart">
              <canvas id="pieChartProjetos"></canvas>
            </div>
            <div class="pie-chart">
              <canvas id="pieChartCredenciamento"></canvas>
            </div>
          </div>
        </div>

        <!-- Gráficos de Comparação -->
        <div class="section">
          <!-- Gráficos de linha/barra Gyn/Int e Evolução permanecem aqui -->
          <div class="section-title">Comparativos de Arrecadação</div>
          <div class="chart-row">
            <div class="chart-container">
              <canvas id="locationChart"></canvas>
            </div>
            <div class="chart-container">
              <canvas id="yearlyComparisonChart"></canvas>
            </div>
          </div>
        </div>

        <!-- SEÇÃO DA TABELA FOI MOVIDA -->
      </div>
      <!-- Fim da Aba Visão Geral -->

      <!-- Conteúdo da Nova Aba Detalhamento OBM (NOVO) -->
      <div id="detalhamentoOBM" class="tab-content">
        <!-- Tabela Detalhada de OBMs com filtros de ano para comparação -->
        <div class="section">
          <div class="section-title">Detalhamento por OBM</div>
          <div class="filter-section">
            <div class="filter-group">
              <label for="yearInitial">Ano Inicial:</label>
              <select id="yearInitial">
                <option value="2022">2022</option>
                <option value="2023">2023</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="yearFinal">Ano Final:</label>
              <select id="yearFinal">
                <option value="2023">2023</option>
                <option value="2024" selected>2024</option>
              </select>
            </div>
            <!-- O botão de atualizar (se existisse) ou outros controles da tabela viriam aqui -->
          </div>
          <div class="table-container">
            <table id="detailedTable">
              <thead>
                <tr>
                  <th>OBM</th>
                  <th>2022 (R$)</th>
                  <th>2023 (R$)</th>
                  <th>2024 (R$)</th>
                  <th id="variationHeader">Variação 2022-2024</th>
                  <!-- O texto será atualizado via JS -->
                </tr>
              </thead>
              <tbody>
                <!-- Preenchido via JavaScript -->
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <!-- Fim da Aba Detalhamento OBM -->

      <!-- Conteúdo da Aba Comparar OBMs (Permanece o mesmo da resposta anterior) -->
      <div id="compararOBMs" class="tab-content">
        <div class="section">
          <div class="section-title">Comparativo de Arrecadação entre OBMs</div>

          <div class="obm-comparison-controls">
            <label for="obmAddDropdown"
              ><strong>Adicionar OBM à comparação:</strong></label
            >
            <select id="obmAddDropdown">
              <option value="" disabled selected>
                Selecione para adicionar...
              </option>
              <!-- Opções serão adicionadas via JavaScript -->
            </select>
          </div>

          <div id="selectedOBMListContainer" style="display: none">
            <!-- Começa escondido -->
            <p><strong>OBMs em comparação:</strong></p>
            <div id="selectedOBMList">
              <!-- Lista de OBMs selecionadas será exibida aqui -->
            </div>
          </div>

          <div class="obm-comparison-chart-container">
            <canvas id="obmComparisonChart"></canvas>
          </div>
          <p
            id="obmComparisonMessage"
            style="text-align: center; margin-top: 15px"
          >
            Selecione uma OBM no menu acima para começar a comparar.
          </p>
        </div>
      </div>
      <!-- Fim da Aba Comparar OBMs -->

      <!-- Conteúdo da Aba Rankings e Análises -->
      <div id="rankingsAnalises" class="tab-content">
        <!-- Seção de Rankings de OBMs -->
        <div class="section">
          <div class="section-title">Rankings de OBMs</div>
          
          <!-- Controles de filtro para a seção de rankings -->
          <div class="filter-section">
            <div class="filter-group">
              <label for="rankingType">Tipo de Ranking:</label>
              <select id="rankingType">
                <option value="arrecadacao">Arrecadação Total</option>
                <option value="crescimentoPercentual">Crescimento Percentual</option>
                <option value="crescimentoNominal">Crescimento Nominal</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="rankingYearInitial">Ano Inicial:</label>
              <select id="rankingYearInitial">
                <option value="2022">2022</option>
                <option value="2023">2023</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="rankingYearFinal">Ano Final:</label>
              <select id="rankingYearFinal">
                <option value="2023">2023</option>
                <option value="2024" selected>2024</option>
              </select>
            </div>
          </div>
          
          <div class="rankings-container">
            <div class="chart-row rankings-charts-row">
              <div class="chart-container rankings-chart">
                <div class="sub-section-title">Top 10 OBMs</div>
                <canvas id="topOBMsChart"></canvas>
              </div>
              <div class="chart-container rankings-chart">
                <div class="sub-section-title">Bottom 10 OBMs</div>
                <canvas id="bottomOBMsChart"></canvas>
              </div>
            </div>
          </div>
        </div>

        <!-- Seção de Contribuição para o Total -->
        <div class="section">
          <div class="section-title">Contribuição para o Total</div>
          
          <!-- Controles de filtro para a seção de contribuição -->
          <div class="filter-section contribution-filter">
            <div class="filter-group">
              <label for="contributionYear">Ano:</label>
              <select id="contributionYear">
                <option value="2022">2022</option>
                <option value="2023">2023</option>
                <option value="2024" selected>2024</option>
              </select>
            </div>
          </div>
          
          <div class="contribuicao-container">
            <div class="chart-container contribution-chart-container">
              <canvas id="contributionChart"></canvas>
            </div>
            <div class="contribution-summary" id="contributionSummary">
              <!-- Resumo textual será adicionado aqui via JavaScript -->
            </div>
          </div>
        </div>

        <!-- Seção de Performance Relativa à Média -->
        <div class="section">
          <div class="section-title">Performance Relativa à Média</div>
          
          <!-- Controles de filtro para a seção de performance relativa -->
          <div class="filter-section performance-filter">
            <div class="filter-group">
              <label for="performanceYear">Ano:</label>
              <select id="performanceYear">
                <option value="2022">2022</option>
                <option value="2023">2023</option>
                <option value="2024" selected>2024</option>
              </select>
            </div>
            <div class="filter-group">
              <label for="performanceView">Visualização:</label>
              <select id="performanceView">
                <option value="top20">Top 20 OBMs</option>
                <option value="all">Todas as OBMs</option>
              </select>
            </div>
          </div>
          
          <div class="performance-container">
            <div class="performance-chart-container">
              <canvas id="performanceChart"></canvas>
            </div>
            <div class="performance-summary" id="performanceSummary">
              <!-- Resumo textual será adicionado aqui via JavaScript -->
            </div>
          </div>
        </div>

      
      <!-- Fim da Aba Rankings e Análises -->
    </div>

    <!-- Carregando a biblioteca Chart.js e plugins -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-datalabels/2.2.0/chartjs-plugin-datalabels.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/hammer.js/2.0.8/hammer.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-zoom/1.2.1/chartjs-plugin-zoom.min.js"></script>
    <script src="script.js"></script>
  </body>
</html>
